# WaterQualiy
Water Quality retrieval from imaging spectrometer data

## Running code
### Training 
Main script for training is run.py. 
- To run the code: ```run.py -y <path to config.yaml>```
- To view training and validation losses: ```tensorboard --logdir <path to model directory>```

Results are automatically saved and plotted in the associated test/train directories 

## MDN Resources
[MDN tutorial and code](https://notebook.community/hardmaru/pytorch_notebooks/mixture_density_networks)

[MDN code from Pahlevan et al.](https://github.com/BrandonSmithJ/MDN)

[Pahlevan et al. 2021 - Hyperspectral retrievals of phytoplankton absorption and chl-a.pdf](https://github.jpl.nasa.gov/smauceri/WaterQuality/files/13649/Pahlevan.et.al.2021.-.Hyperspectral.retrievals.of.phytoplankton.absorption.and.chl-a.pdf)

[Pahlevan et al. 2020 -  Seamless retrievls of chl-a from Sentinel-2.pdf](https://github.jpl.nasa.gov/smauceri/WaterQuality/files/13650/Pahlevan.et.al.2020.-.Seamless.retrievls.of.chl-a.from.Sentinel-2.pdf)

## DE Resources
[Deep Ensembles code](https://github.com/mpritzkoleit/deep-ensembles/blob/master/Deep%20Ensembles.ipynb)

[PyTorch version](https://seunghan96.github.io/bnn/code-4.Deep-Ensembles/)

[Toy example](https://github.com/cpark321/uncertainty-deep-learning/blob/master/03.%20Simple%20and%20Scalable%20Predictive%20Uncertainty%20Estimation%20using%20Deep%20Ensembles.ipynb)

[Lakshminarayanan et al. 2017 - Simple and Scalable Predictive Uncertainty Est. Using Deep Ensembles.pdf](https://github.jpl.nasa.gov/smauceri/WaterQuality/files/13782/Lakshminarayanan.et.al.2017.-.Simple.and.Scalable.Predictive.Uncertainty.Est.Using.Deep.Ensembles.pdf)

## Presentations
[Laurel's final internship presentation](https://github.jpl.nasa.gov/smauceri/WaterQuality/files/13913/Final_presentation_Laurel.pptx)

